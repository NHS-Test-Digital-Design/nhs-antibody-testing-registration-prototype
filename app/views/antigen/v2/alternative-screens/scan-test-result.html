{% set version = "v2" %}
{% set pageTitle = "Scan your test result" %}

{% extends "includes/layout.html" %}

{% block beforeContent %}
<div class="govuk-phase-banner">
  <p class="govuk-phase-banner__content">
    <strong class="govuk-tag govuk-phase-banner__content__tag">
      alpha
    </strong>
    <span class="govuk-phase-banner__text">
      This is a new service â€“ your <a class="govuk-link" href="#">feedback</a> will help us to improve it.
    </span>
  </p>
</div>

  <a class="govuk-back-link" href="/antigen/{{version}}/home-testing/enter-barcode-number">Back</a>
{% endblock %}

{% block content %}
  {% include "includes/gtm-noscript.html" %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
  
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-3">{{ pageTitle }}</h1>
        <p class="govuk-body">Position the barcode so it fits inside the square on your mobile or computer's camera.</p>

        <div style="position: relative; transform: scaleX(-1); display: flex; justify-content: center; align-items: center;" class="camera-test-result">
          <div style="border: dashed white 2px; width: 90px; height: 360px; position: absolute;"></div>
          <div style="border: dashed white 2px; width: 36px; height: 80px; position: absolute; margin-top: -50px"></div>
          <div style="position: absolute; background-color: rgba(0,0,0,.3); width: 41%; height: 100%; right: 0"></div>
          <div style="position: absolute; background-color: rgba(0,0,0,.3); width: 41%; height: 100%; left: 0"></div>
          <video id="video" class="camera-test-result" autoplay capture="environment"></video>
        </div>
        <br><br>
        
        <a href="/antigen/{{version}}/home-testing/enter-barcode-number" role="button" draggable="false" class="govuk-button govuk-!-margin-top-2 govuk-!-margin-bottom-8" data-module="govuk-button">
          Cancel
        </a>
  
    </div>
  </div>

  <script type="text/javascript">

// var constraintsObject = { facingMode: constraint };

// constraintsObject.facingMode = constraint;

// var constraints = {
//   facingMode: { exact: "user" }
// };
  

// Grab elements, create settings, etc.
var video = document.getElementById('video');

// Get access to the camera!
// if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
//     // Not adding `{ audio: true }` since we only want video now
//     navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
//         //video.src = window.URL.createObjectURL(stream);
//         video.srcObject = stream;
//         video.play();
//     });
// }

if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
navigator.mediaDevices.getUserMedia({
  audio: false,
  video: {
    facingMode: 'environment'
  }
})
.then(function(stream) {
        // video.src = window.URL.createObjectURL(stream);
        video.srcObject = stream;
        video.play();
    })
.catch(console.error);
}
  </script>

{% endblock %}